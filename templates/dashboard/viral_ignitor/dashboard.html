{% extends 'dashboard/viral_ignitor/base.html' %}
{% load dashboard_extras %}
{% load i18n %}
{% load static %}
{% block title %} {% trans 'Dashboard' %} {% endblock %}
{% block content %}
<script type="text/javascript">
            $(window).on('load',function(){
                {% if not user|is_email_verified %}
                    $('#initModal').modal('show');
                {% endif %}
                {% if user|is_email_verified %}
                 $('#initModal').modal('hide');
                {% endif %}
            });
        </script>
<script src="{% static 'js/core_post.js' %}"></script>

<div id="initModal" class="modal" tabindex="-1" role="dialog" data-keyboard="false" data-backdrop="static">
  <div class="modal-dialog modal-dialog-centered" role="document">
    <div class="modal-content">
        <div class="card-header custom-box-header">
      <div class="modal-header">
        <h3 class="modal-title">{% trans 'pleaseInsertOTPToVerifyYourEmail' %} </h3>
<!--        <button type="button" class="close" data-dismiss="modal" aria-label="Close">-->
<!--          <span aria-hidden="true">&times;</span>-->
<!--        </button>-->
      </div>
      </div>
      <div class="modal-body">

        <form action="{% url 'verify_otp' %}" method="post" style="top: 100px;" id="intiForm">
          {% csrf_token %}
          <br>
          <input type="text" id="verify_otp" name="verify_otp" placeholder="{% trans 'writeOTPhere' %}" class="form-control" required="True">
          <br>

      </div>
      <div class="modal-footer">
        <button type="submit" class="btn btn-info rounded-pill btn-no-loading"><i class="fas fa-sign-in-alt"></i> Insert</button>
        <br>
          <a href="{% url 'resend_email_otp' %}">{% trans 'clickToResendOtp' %}</a>
          <!-- <button data-dismiss="modal" class="btn-danger" style="border: 0;padding: 7px 20px;border-radius: 30px;color: #fff;display: flex;align-items: center;line-height: 1;">Close</button> -->
        </form>
      </div>
    </div>
  </div>
</div>

<div class="wrapper">
   <div class="subheader dashboard">
      <div class="wrap">
         <div class="subheader-main wrap-m w-100 p-r-0">
            <div class="wrap-c">
               <button type="button" class="btn btn-label-info m-r-10 subheader-toggle"><i
                  class="fas fa-bars"></i></button>
               <h3 class="title"><i class="fas fa-desktop"></i>{% trans 'tasksReport' %}</h3>
            </div>
         </div>
      </div>
   </div>
   <div class="content-one-column nicescroll dashboard">
      <div class="column-one mx-3">
        <br>
         <!-- <center><h3 class="text-info fs-18 m-b-25 "> <i class="far fa-chart-bar"></i>Report</h3></center> -->
         <div class="row">
            <div class="col-lg-12 col-sm-12 m-b-25">
               <div class="card rounded">
                  <div class="card-header wrap-m">
                     <div class="card-title wrap-c text-info"><i class="fas fa-caret-right p-r-5"></i> {% trans 'last' %} 30 {% trans 'days' %}</div>
                  </div>
                  <div class="card-body h-300">
                     <canvas id="line-stacked-area" height="300"></canvas>
                  </div>
                  <script type="text/javascript">
                      $(function(){
                          setTimeout(function(){
                              Core.lineChart(
                                  "line-stacked-area",
                                  {{date|safe}},
                                  [
                                      {{failedJobsCount}},
                                      {{pendingJobsCount}},
                                      {{completedJobsCount}}
                                  ],
                                  [
                                      "Failed","Pending","Success",
                                  ]
                              );
                          }, 300);
                      });
                  </script>

               </div>
            </div>
         </div>
         <div class="row">
            <div class="col-md-3 m-b-25">
               <div class="p-25 bg-solid-success rounded">
                  <div class="wrap-m">
                     <div>
                        <h3 class="success w-100">{{totalcompletedJobsCount}}</h3>
                        <div>{% trans 'successText' %}</div>
                     </div>
                     <div class="wrap-c">
                        <i class="fas fa-paper-plane float-right text-info fs-45"></i>
                     </div>
                  </div>
               </div>
            </div>
            <div class="col-md-3 m-b-25">
               <div class="p-25 bg-solid-danger rounded">
                  <div class="wrap-m">
                     <div>
                        <h3 class="danger">{{totalpendingJobsCount}}</h3>
                        <span>{% trans 'pending' %}</span>
                     </div>
                     <div class="wrap-c">
                        <i class="fas fa-exclamation-triangle float-right text-warning fs-45"></i>
                     </div>
                  </div>
               </div>
            </div>
            <div class="col-md-3 m-b-25">
               <div class="p-25 bg-solid-primary rounded">
                  <div class="wrap-m">
                     <div>
                        <h3 class="primary">{{totalfailedJobsCount}}</h3>
                        <span>{% trans 'failed' %}</span>
                     </div>
                     <div class="wrap-c">
                        <i class="fa fa-info-circle float-right text-primary fs-45"></i>
                     </div>
                  </div>
               </div>
            </div>
            <div class="col-md-3 m-b-25">
               <div class="p-25 bg-solid-info rounded">
                  <div class="wrap-m">
                     <div>
                        <h3 class="primary">{{total_count}}</h3>
                        <span>{% trans 'total' %}</span>
                     </div>
                     <div class="wrap-c">
                        <i class="fas fa-calendar-check float-right text-success fs-45"></i>
                     </div>
                  </div>
               </div>
            </div>
         </div>
      </div>
   </div>
</div>
<form method="post" action="{% url 'dashboard' %}" id="myFormasd">
  {% csrf_token %}
  <input type="hidden" id="insta_user_id" name="insta_user_id">
</form>
{% block script %}
<script type="text/javascript">
    $('#useraccount_select').on('change', function (e) {
      document.getElementById("insta_user_id").value = $(this).val();
      $('#myFormasd').submit()
    });
</script>
{% endblock %}

{% endblock %}